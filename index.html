<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Work Force</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#000000" />

  <!-- iOS standalone -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Work Force" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="/icon-192.png" />

  <style>
    :root{
      --danger:#ff3b30;
      --ok:#34c759;
      --warn:#ffcc00;
      --info:#0a84ff;
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --radius:18px;
      --sheetShadow:0 30px 80px rgba(0,0,0,.25);
    }

    :root[data-theme="light"]{
      --bg:#f2f2f7;
      --card:#ffffff;
      --text:#111;
      --muted:rgba(17,17,17,.55);
      --line:rgba(17,17,17,.08);
      --btn:#111;
      --btnText:#fff;
      --pillBg:rgba(0,0,0,.06);
      --pillBorder:rgba(0,0,0,.06);
      --chipBg:#fff;
      --chipText:#111;
      --chipBorder:var(--line);
      --overlay:rgba(0,0,0,.35);
      --dockGlass:rgba(242,242,247,.82);
      --prioLowBg: rgba(0,0,0,.06);
      --prioLowText: rgba(0,0,0,.75);
      --prioMedBg: rgba(255,204,0,.16);
      --prioMedText: rgba(156,110,0,.95);
      --prioHighBg: rgba(255,59,48,.14);
      --prioHighText: rgba(255,59,48,.95);
    }

    :root[data-theme="dark"]{
      --bg:#0b0b0f;
      --card:#14141b;
      --text:#f5f5f7;
      --muted:rgba(245,245,247,.55);
      --line:rgba(245,245,247,.12);
      --btn:#f5f5f7;
      --btnText:#0b0b0f;
      --pillBg:rgba(245,245,247,.08);
      --pillBorder:rgba(245,245,247,.10);
      --chipBg:#14141b;
      --chipText:#f5f5f7;
      --chipBorder:rgba(245,245,247,.14);
      --overlay:rgba(0,0,0,.55);
      --dockGlass:rgba(10,10,14,.72);
      --prioLowBg: rgba(245,245,247,.08);
      --prioLowText: rgba(245,245,247,.85);
      --prioMedBg: rgba(255,204,0,.20);
      --prioMedText: rgba(255,216,77,.95);
      --prioHighBg: rgba(255,59,48,.20);
      --prioHighText: rgba(255,120,112,.95);
    }

    :root[data-theme="charcoal"]{
      --bg:#121214;
      --card:#1c1c1f;
      --text:#f2f2f4;
      --muted:rgba(242,242,244,.55);
      --line:rgba(242,242,244,.10);
      --btn:#f2f2f4;
      --btnText:#121214;
      --pillBg:rgba(242,242,244,.08);
      --pillBorder:rgba(242,242,244,.10);
      --chipBg:#1c1c1f;
      --chipText:#f2f2f4;
      --chipBorder:rgba(242,242,244,.14);
      --overlay:rgba(0,0,0,.55);
      --dockGlass:rgba(10,10,14,.72);
      --prioLowBg: rgba(242,242,244,.08);
      --prioLowText: rgba(242,242,244,.85);
      --prioMedBg: rgba(255,204,0,.20);
      --prioMedText: rgba(255,216,77,.95);
      --prioHighBg: rgba(255,59,48,.20);
      --prioHighText: rgba(255,120,112,.95);
    }

    :root[data-theme="ocean"]{
      --bg:#07131f;
      --card:#0f2237;
      --text:#eaf3ff;
      --muted:rgba(234,243,255,.55);
      --line:rgba(234,243,255,.12);
      --btn:#eaf3ff;
      --btnText:#07131f;
      --pillBg:rgba(234,243,255,.10);
      --pillBorder:rgba(234,243,255,.12);
      --chipBg:#0f2237;
      --chipText:#eaf3ff;
      --chipBorder:rgba(234,243,255,.16);
      --overlay:rgba(0,0,0,.55);
      --dockGlass:rgba(10,10,14,.72);
      --prioLowBg: rgba(234,243,255,.10);
      --prioLowText: rgba(234,243,255,.92);
      --prioMedBg: rgba(255,204,0,.20);
      --prioMedText: rgba(255,220,112,.95);
      --prioHighBg: rgba(255,59,48,.22);
      --prioHighText: rgba(255,140,132,.95);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -webkit-text-size-adjust:100%;
      overscroll-behavior-y:none;
    }

    .app{
      max-width:980px;
      margin:0 auto;
      padding:18px 16px 122px;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin:6px 0 14px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }

    h1{
      margin:0;
      font-size:28px;
      letter-spacing:-0.02em;
    }

    .sub{
      margin:0;
      font-size:13px;
      color:var(--muted);
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .btn{
      border:none;
      border-radius:14px;
      padding:12px 14px;
      background:var(--btn);
      color:var(--btnText);
      font-weight:1000;
      cursor:pointer;
      transition:transform .05s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:active{ transform:scale(.99); }
    .btn.secondary{
      background:transparent;
      color:var(--text);
      border:1px solid var(--line);
      font-weight:1000;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background:var(--pillBg);
      border:1px solid var(--pillBorder);
      font-size:12px;
      color:var(--text);
      white-space:nowrap;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .sectionHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px 14px;
      border-bottom:1px solid var(--line);
    }

    .sectionTitle{
      font-weight:1000;
      letter-spacing:-0.01em;
      display:flex;
      gap:10px;
      align-items:center;
    }

    .badge{
      font-size:12px;
      font-weight:1000;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
    }

    .composer{
      padding:14px;
      display:grid;
      gap:10px;
    }

    input, select, textarea, button{ font:inherit; }

    input[type="text"], input[type="datetime-local"], select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:var(--card);
      color:var(--text);
      outline:none;
    }

    textarea{ resize:none; min-height:84px; }

    input:focus, select:focus, textarea:focus{
      border-color:rgba(127,127,127,.45);
    }

    .chip{
      border:1px solid var(--chipBorder);
      background:var(--chipBg);
      color:var(--chipText);
      border-radius:999px;
      padding:8px 10px;
      font-weight:1000;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
    }
    .chip.on{
      background:var(--btn);
      color:var(--btnText);
      border-color:var(--btn);
    }

    .whenLabel{
      margin-left:auto;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
    }

    .hint{
      font-size:12px;
      color:var(--muted);
      padding:10px 14px 0;
    }

    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
    }
    @media (min-width: 980px){
      .grid{ grid-template-columns: 1.35fr .65fr; }
    }

    /* LIST + SWIPE */
    .list{ }

    .swipeWrap{
      position:relative;
      border-top:1px solid var(--line);
      overflow:hidden;
      background:var(--card);
    }
    .swipeWrap:first-child{ border-top:none; }

    .swipeBg{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 14px;
      font-weight:1000;
      user-select:none;
      pointer-events:none;
      letter-spacing:.01em;
    }
    .bgDone{ background:var(--ok); color:#fff; }
    .bgDel{ background:var(--danger); color:#fff; justify-content:flex-end; }

    .rowFront{
      position:relative;
      background:var(--card);
      padding:14px;
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      transform:translateX(0px);
      transition:transform .18s ease;
      will-change: transform;
      touch-action: pan-y;
    }
    .rowFront.dragging{ transition:none; }

    .left{
      display:flex;
      gap:12px;
      align-items:flex-start;
      min-width:0;
      flex:1;
    }

    .check{
      width:22px;
      height:22px;
      border-radius:7px;
      border:1.5px solid rgba(127,127,127,.5);
      flex:0 0 auto;
      margin-top:2px;
      display:grid;
      place-items:center;
      background:transparent;
      color:var(--text);
      cursor:pointer;
      user-select:none;
    }
    .check.on{
      background:var(--btn);
      border-color:var(--btn);
      color:var(--btnText);
    }

    .textWrap{ min-width:0; flex:1; }
    .task{
      margin:0;
      font-size:16px;
      line-height:1.2;
      word-break:break-word;
    }

    .meta{
      margin:8px 0 0;
      font-size:12px;
      color:var(--muted);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .pillMini{
      display:inline-flex;
      align-items:center;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      font-size:11px;
      font-weight:1000;
      white-space:nowrap;
    }
    .pillMini.low{ background:var(--prioLowBg); color:var(--prioLowText); border-color:transparent; }
    .pillMini.medium{ background:var(--prioMedBg); color:var(--prioMedText); border-color:transparent; }
    .pillMini.high{ background:var(--prioHighBg); color:var(--prioHighText); border-color:transparent; }

    .pillMini.status{
      background:rgba(10,132,255,.14);
      color:rgba(10,132,255,.95);
      border-color:transparent;
    }

    .pillMini.tech{
      background:rgba(127,127,127,.14);
      color:var(--muted);
      border-color:transparent;
    }

    .actions{
      display:flex;
      gap:8px;
      flex:0 0 auto;
      align-items:center;
    }

    .iconBtn{
      border:1px solid var(--line);
      background:transparent;
      color:var(--text);
      border-radius:12px;
      padding:9px 10px;
      cursor:pointer;
      font-weight:1000;
      user-select:none;
      white-space:nowrap;
    }
    .iconBtn.danger{
      color:var(--danger);
      border-color:rgba(255,59,48,.25);
    }

    @keyframes popIn{
      from{ opacity:0; transform:translateY(10px); }
      to{ opacity:1; transform:translateY(0); }
    }
    .animateIn{ animation: popIn .18s ease both; }

    .fadeOut{
      opacity:0;
      transform:translateY(-6px);
      transition: opacity .18s ease, transform .18s ease;
    }

    /* Filters */
    .filters{
      padding:12px 14px;
      border-top:1px solid var(--line);
      display:grid;
      gap:10px;
    }
    .filters .row > *{ flex: 1 1 160px; }
    .search{
      flex: 2 1 240px !important;
    }

    /* Dock */
    .dock{
      position:fixed;
      left:0; right:0; bottom:0;
      padding:10px 12px calc(10px + env(safe-area-inset-bottom));
      background:var(--dockGlass);
      border-top:1px solid var(--line);
      backdrop-filter:saturate(180%) blur(18px);
    }
    .dockInner{
      max-width:980px;
      margin:0 auto;
      display:flex;
      gap:10px;
    }
    .dockInner .btn{ flex:1; }

    /* Edit sheet */
    .overlay{
      position:fixed;
      inset:0;
      background:var(--overlay);
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease;
    }
    .overlay.open{ opacity:1; pointer-events:auto; }

    .sheet{
      position:fixed;
      left:0; right:0; bottom:0;
      transform:translateY(110%);
      transition:transform .22s ease;
      padding:10px 12px calc(12px + env(safe-area-inset-bottom));
    }
    .sheet.open{ transform:translateY(0); }

    .sheetCard{
      max-width:980px;
      margin:0 auto;
      background:var(--card);
      border:1px solid var(--line);
      border-radius:22px;
      box-shadow:var(--sheetShadow);
      overflow:hidden;
    }
    .sheetTop{
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid var(--line);
    }
    .sheetTitle{ font-weight:1000; letter-spacing:-0.01em; }
    .sheetBody{ padding:14px; display:grid; gap:10px; }
    .sheetActions{
      padding:12px 14px;
      border-top:1px solid var(--line);
      display:flex;
      gap:10px;
    }
    .sheetActions .btn{ flex:1; }
    .dangerBtn{
      border:1px solid rgba(255,59,48,.25) !important;
      color:var(--danger) !important;
      background:transparent !important;
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="title">
        <h1>Work Force</h1>
        <p class="sub">Company scheduling for service calls (priority â€¢ status â€¢ tech â€¢ click-to-call).</p>
      </div>

      <div class="row" style="justify-content:flex-end;">
        <button class="btn secondary" id="themeBtn" type="button">Theme</button>
        <div class="pill" id="statsPill">0 open Â· 0 total</div>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: Calls -->
      <div class="card">
        <div class="sectionHead">
          <div class="sectionTitle">Service Calls <span class="badge" id="countBadge">0</span></div>
          <button class="btn secondary" id="clearDoneBtn" type="button">Clear Done</button>
        </div>

        <div class="composer">
          <div class="row">
            <input id="custInput" type="text" placeholder="Customer / Company" autocomplete="off" />
            <input id="phoneInput" type="text" placeholder="Phone (optional)" inputmode="tel" />
          </div>

          <div class="row">
            <input id="addrInput" type="text" placeholder="Address / Location" />
          </div>

          <div class="row">
            <input id="whenInput" type="datetime-local" />
            <select id="prioInput" aria-label="Priority">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="high">High</option>
            </select>
            <select id="statusInput" aria-label="Status">
              <option value="new" selected>New</option>
              <option value="scheduled">Scheduled</option>
              <option value="enroute">En Route</option>
              <option value="onsite">On Site</option>
              <option value="completed">Completed</option>
            </select>
          </div>

          <div class="row">
            <select id="techInput" aria-label="Assigned Tech">
              <option value="" selected>Unassigned</option>
              <option value="Lane">Lane</option>
              <option value="Tech 2">Tech 2</option>
              <option value="Tech 3">Tech 3</option>
            </select>
            <button class="btn secondary" id="addTechBtn" type="button">Add Techâ€¦</button>
          </div>

          <div class="row" style="gap:8px;">
            <button class="chip" type="button" data-quick="none">No time</button>
            <button class="chip" type="button" data-quick="1h">In 1 hour</button>
            <button class="chip" type="button" data-quick="6pm">Today 6pm</button>
            <button class="chip" type="button" data-quick="tom9">Tomorrow 9am</button>
            <span class="whenLabel" id="whenLabel">No time set</span>
          </div>

          <div class="row">
            <textarea id="notesInput" placeholder="Notes (issue, parts needed, gate code, etc.)"></textarea>
          </div>

          <div class="row">
            <button class="btn" id="addBtn" type="button">Add Service Call</button>
          </div>

          <div class="hint">Mobile: swipe right âœ… complete Â· swipe left ðŸ—‘ delete Â· tap to edit. Desktop: use the buttons on each row.</div>
        </div>

        <div class="list" id="list"></div>
      </div>

      <!-- RIGHT: Filters / Team -->
      <div class="card">
        <div class="sectionHead">
          <div class="sectionTitle">Filters</div>
          <button class="btn secondary" id="resetFiltersBtn" type="button">Reset</button>
        </div>

        <div class="filters">
          <div class="row">
            <input class="search" id="searchInput" type="text" placeholder="Search customer, address, notesâ€¦" />
          </div>

          <div class="row">
            <select id="filterTech">
              <option value="" selected>All techs</option>
            </select>
            <select id="filterStatus">
              <option value="" selected>All statuses</option>
              <option value="new">New</option>
              <option value="scheduled">Scheduled</option>
              <option value="enroute">En Route</option>
              <option value="onsite">On Site</option>
              <option value="completed">Completed</option>
            </select>
          </div>

          <div class="row">
            <select id="filterPriority">
              <option value="" selected>All priorities</option>
              <option value="high">High</option>
              <option value="medium">Medium</option>
              <option value="low">Low</option>
            </select>
            <select id="filterDone">
              <option value="open" selected>Open only</option>
              <option value="all">All (incl. done)</option>
              <option value="done">Done only</option>
            </select>
          </div>

          <div class="hint" style="padding:0;">Tip: set filters for dispatch view, then share the URL to your team (same link).</div>
        </div>
      </div>
    </div>
  </div>

  <div class="dock">
    <div class="dockInner">
      <button class="btn secondary" id="notifyBtn" type="button">Enable Notifications</button>
      <button class="btn" id="focusAddBtn" type="button">Quick Add</button>
    </div>
  </div>

  <!-- Edit Sheet -->
  <div class="overlay" id="overlay"></div>
  <div class="sheet" id="sheet">
    <div class="sheetCard">
      <div class="sheetTop">
        <div class="sheetTitle">Edit Service Call</div>
        <button class="btn secondary" id="closeSheetBtn" type="button">Close</button>
      </div>

      <div class="sheetBody">
        <div class="row">
          <input id="eCust" type="text" placeholder="Customer / Company" />
          <input id="ePhone" type="text" placeholder="Phone (optional)" inputmode="tel" />
        </div>

        <input id="eAddr" type="text" placeholder="Address / Location" />

        <div class="row">
          <input id="eWhen" type="datetime-local" />
          <select id="ePrio" aria-label="Priority">
            <option value="low">Low</option>
            <option value="medium">Medium</option>
            <option value="high">High</option>
          </select>
          <select id="eStatus" aria-label="Status">
            <option value="new">New</option>
            <option value="scheduled">Scheduled</option>
            <option value="enroute">En Route</option>
            <option value="onsite">On Site</option>
            <option value="completed">Completed</option>
          </select>
        </div>

        <div class="row">
          <select id="eTech" aria-label="Assigned Tech"></select>
          <button class="btn secondary" id="eAddTechBtn" type="button">Add Techâ€¦</button>
        </div>

        <div class="row" style="gap:8px;">
          <button class="chip" type="button" data-equick="none">No time</button>
          <button class="chip" type="button" data-equick="1h">In 1 hour</button>
          <button class="chip" type="button" data-equick="6pm">Today 6pm</button>
          <button class="chip" type="button" data-equick="tom9">Tomorrow 9am</button>
          <span class="whenLabel" id="eWhenLabel">No time set</span>
        </div>

        <textarea id="eNotes" placeholder="Notes"></textarea>
      </div>

      <div class="sheetActions">
        <button class="btn dangerBtn" id="deleteBtn" type="button">Delete</button>
        <button class="btn" id="saveBtn" type="button">Save</button>
      </div>
    </div>
  </div>
